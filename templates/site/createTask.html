<!DOCTYPE HTML>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
        <link rel="stylesheet" type="text/css" href="static/css/reset.css"/>
        <link rel="stylesheet" type="text/css" href="static/css/style.css"/>
        <link rel="stylesheet" type="text/css" href="static/css/tree.css"/>
        <link rel="stylesheet" type="text/css" href="static/css/status.css"/>
        <link rel="stylesheet" type="text/css" href="static/css/bootstrap.css" />
                <link rel="stylesheet" type="text/css" href="static/css/select2.css" />
<link rel="stylesheet" type="text/css" href="static/css/jquery-ui.css" />
<link rel="stylesheet" type="text/css" href="static/css/create_task_style.css" />
<link rel="stylesheet" type="text/css" href="static/css/search.css" />
<script type="text/javascript" src="static/js/jquery.min.js"></script>
<script type="text/javascript" src="static/js/jquery-ui.min.js"></script>
<script type="text/javascript" src="static/js/select2.min.js"></script>
<script type="text/javascript" src="static/js/masspicker.js"></script>
<script type="text/javascript" src="static/js/jquery.ui.widget.min.js"></script>
<script type="text/javascript" src="static/js/jquery.ui.combobox.js"></script>
<script type="text/javascript" src="static/js/qb.js"></script>
<title>TOAST</title>
        <script type="text/javascript" src="static/js/lib.js"></script>
        <script type="text/javascript" src="static/js/lib.cookie.js"></script>
        <script type="text/javascript" src="static/js/lib.treeview.js"></script>
        <script type="text/javascript" src="static/js/config.js"></script>
        <script type="text/javascript" src="static/js/lang.js"></script>
        <script type="text/javascript" src="static/js/bootstrap.js"></script>
        <script type="text/javascript" src="static/js/lib.form.js"></script>
<script type="text/javascript" src="static/js/task.js"></script>

            <script type="text/javascript" src="static/js/cron.js"></script>
<script type="text/javascript" src="static/js/lang_zh-CN.js"></script>
    </head>
    <body>
        <div class="bg">
            <div class="header">
                <div class="logo">
                    <a href="/task">
                        <img alt="TOAST" src="/themes/classic/assets/images/page_logo.png" />
                    </a>
                </div>
                <ul id="nav">
<li class="active"><a href="/task">任务</a></li>
<li><a href="/report">报表</a></li>
<li><a href="/case">用例</a></li>
<li><a href="/machine">测试机</a></li>
</ul><ul id="user">
<li><a id="username" href="/admin/user/update/id/2">Admin(Admin)</a></li>
<li><a href="/admin">管理入口</a></li>
<li class="last"><a href="/logout">退出</a></li>
</ul>            </div>
            <div class="notify hidden">
                NOTIFY BAR
            </div>
            <link rel="stylesheet" type="text/css" href="static/css/task.css" />
<div class="content">
    <div class="sub-nav">
    <ul id="path-nav">
<li class="first last"><span>新建任务</span></li>
</ul>    </div>
    <div class="main-detail">
        <form action="/createTask" method="post">        <div class="button-actions clearfix">
            <input class="btn" name="saverun" type="submit" value="保存并运行" /><input class="btn" name="save" type="submit" value="保存" /><input class="btn return" name="yt0" type="button" value="返回" />        </div>
                <div class="detail block basic-info clearfix">
            <div class="row-fluid">
                <label class="span1 required" for="Task_type">任务类型<span class="required">*</span></label>
                <select class="span2" name="Task[type]" id="Task_type">
<option value="" selected="selected"></option>
<option value="1">单元测试</option>
<option value="3">功能测试</option>
<option value="6">持续集成</option>
</select><label class="span1 offset1 required" for="Task_name">任务名称 <span class="required">*</span></label><input class="focus span7" name="Task[name]" id="Task_name" type="text" maxlength="128" />            </div>
            <div class="row-fluid">
                <label class="span1 required" for="Task_responsible">负责人 <span class="required">*</span></label><input name="Task[responsible_realname]" id="Task_responsible_realname" type="hidden" value="Admin" /><input class="span2" name="Task[responsible]" id="Task_responsible" type="text" value="2" /><label class="span1 offset1 required" for="Task_project_id">所属项目 <span class="required">*</span></label><input type="hidden" value="1" name="product-id" id="product-id" /><input name="Task[project_id]" id="Task_project_id" type="hidden" /><input class="focus span7" placeholder="/Sample" id="Task_project_id-input" type="text" value="" />            </div>
            <div class="row-fluid">
                <label class="span1" for="Task_cron_time">定时运行</label><input class="focus span2" readonly="readonly" name="Task[cron_time]" id="Task_cron_time" type="text" /><div style="display:none" id="dlg_Task_cron_time">
<style>
    .row-fluid .btn {
        margin-right: 0;
    }
    .custom.well,
    .cron-tip.well {
        margin-bottom: 5px;
        word-break:break-all;
        color: #333;
    }
</style>
<div class="row-fluid">
    <input class="btn span3" role="every_day" type="button" value="每日" />
    <input class="btn span3" role="every_week" type="button" value="每周" />
    <input class="btn span3" role="every_month" type="button" value="每月" />
    <input class="btn span3" role="every_hour" type="button" value="每小时" />
</div>
<div class="row-fluid">
    <div class="custom well well-small basic-info">
        <div class="row-fluid">
            <label class="offset1 span1">分钟</label>
            <input class="span9 focus" role="input_minute" />
        </div>
        <div class="row-fluid">
            <label class="offset1 span1">小时</label>
            <input class="span9 focus" role="input_hour" />
        </div>
        <div class="row-fluid">
            <label class="offset1 span1">日</label>
            <input class="span9 focus" role="input_day" />
        </div>
        <div class="row-fluid">
            <label class="offset1 span1">月</label>
            <input class="span9 focus" role="input_month" />
        </div>
        <div class="row-fluid">
            <label class="offset1 span1">星期</label>
            <input class="span9 focus" role="input_week" />
        </div>
    </div>
</div>
<div class="cron-tip well well-small">TIP</div>
</div><div class="offset1 span3 exclusive-checkbox"><label style="float: left; margin-right: 5px" title="同一时刻只允许该任务的一个运行实例" for="Task_exclusive">互斥运行</label><input id="ytTask_exclusive" type="hidden" value="0" name="Task[exclusive]" /><input style="margin-right: 30px" title="同一时刻只允许该任务的一个运行实例" name="Task[exclusive]" id="Task_exclusive" value="1" checked="checked" type="checkbox" /><label style="float: left; margin-right: 5px" title="运行环境无法通信时使任务处于等待状态" for="Task_wait_machine">等待运行环境</label><input id="ytTask_wait_machine" type="hidden" value="0" name="Task[wait_machine]" /><input title="运行环境无法通信时使任务处于等待状态" name="Task[wait_machine]" id="Task_wait_machine" value="1" type="checkbox" /></div>            </div>
            <div class="row-fluid">
                <label class="span1" for="Task_build">Build触发</label><input class="focus span11" placeholder="填写包名（如&quot;t-test-toast&quot;, 不带版本号），多个包名以&quot;,&quot;分割，可以通过API触发任务执行，命令可以通过添加参数 $BUILD 获取到新包" name="Task[build]" id="Task_build" type="text" value="" />            </div>
            <div class="row-fluid">
                <label class="span1" for="Task_svn_url">SVN触发</label><input class="focus span11" placeholder="填写SVN URL, 当SVN发生提交时触发任务执行" name="Task[svn_url]" id="Task_svn_url" type="text" />            </div>
            <div class="row-fluid">
                <label class="span1" for="Task_report_to">邮件通知</label><select class="span2" name="Task[report_filter]" id="Task_report_filter">
<option value=""></option>
<option value="0">不通知</option>
<option value="1">失败时通知</option>
<option value="2" selected="selected">全部通知</option>
</select><input class="span9" name="Task[report_to]" id="Task_report_to" type="text" maxlength="255" />            </div>
        </div>
        <div class="stage-detail follow block">
            <div class="close"><a href="javascript:;">X</a><span class="stage-name">阶段 1</span></div>
            <div class="stage stage-sortable">
            <div class="add-job"><a href="javascript:;">添加子任务</a>
            </div>
            </div>
        </div>
        <div class="add-stage">
            <a href="javascript:;">增加阶段</a>        </div>
    </form>    </div>
</div>
<script type="text/javascript" src="static/js/job.form.js?ver=1"></script>
<div style="display:none; overflow-x:hidden; font-size: 13px;" id="dlg-add-job">
<form enctype="multipart/form-data" id="job-form" action="/createTask" method="post"><div id="job-error" class="errorSummary" style="margin-bottom: 10px; display: none"></div><ul id="run-tabs">
    <li id="command-tab" class="selected">命令模式</li><li id="test-case-tab">用例模式</li>
</ul>
<div id="run-fields">
    <!-- command fields start -->
    <div id="command-fields">
        <div class="row-fluid">
            <label class="span2" for="Command_name">命令名称</label><select name="Job[command_id]" id="Job_command_id">
<option value="" selected="selected"></option>
<option value="-1">[新建命令]</option>
</select><input class="focus span10" placeholder="输入命令名称" id="Job_command_id_input" type="text" /><input name="Job[id]" id="Job_id" type="hidden" /><input name="Job[stage_num]" id="Job_stage_num" type="hidden" /><input name="Command[name]" id="Command_name" type="hidden" /><input name="Command[mode]" id="Command_mode" type="hidden" value="0" /><input id="Job_type" type="hidden" value="0" name="Job[type]" />        </div>
        <div class="row-fluid" style="margin-bottom: 0">
            <label class="span2" for="Command_command">命令内容</label>            <div class="span10">
                <ul id="command-tabs">
                    <li id="basic-command-tab" class="selected">命令视图</li>
                    <li id="ut-command-tab">单元测试</li>
                    <li id="ci-command-tab">持续集成</li>
                </ul>
                <!-- basic command fields start -->
                <div id="basic-command-fields" class="field-with-border">
                    <label>命令</label>                    <div class="row-fluid">
                        <textarea class="focus span12" rows="6" placeholder="当Build触发任务执行时，可以通过添加参数 $BUILD 获取到新包， 通过添加参数 $TASK_RUN_ID 获得当前任务运行结果ID" name="Command[command]" id="Command_command"></textarea>                    </div>
                    <hr/>
                    <div class="row-fluid" style="margin-bottom: 0">
                        <label class="span2" for="Command_parser_id">解析方式</label><select multiple="multiple" class="span10" placeholder="不解析" name="Command[parser_id][]" id="Command_parser_id">
<option value="1">GTest-txt</option>
<option value="2">GTest-xml</option>
<option value="3">Perl</option>
<option value="4">PHPUnit-xml</option>
<option value="5">CPPUnit</option>
<option value="6">JUnit-ant</option>
<option value="7">JUnit-orig</option>
<option value="8">JUnit-mvn</option>
<option value="9">Mocha</option>
<option value="10">Grails</option>
<option value="11">PyUnit</option>
<option value="12">Perl Test::Class</option>
<option value="13">NUnit</option>
<option value="14">ApsaraUnit</option>
<option value="15">ShellUnit</option>
<option value="16">LightFace</option>
<option value="17">Toast</option>
<option value="18">NoseTests</option>
<option value="19">Lua</option>
</select>                    </div>
                </div>
                <!-- basic command fields end -->
                <!-- ut command fields start -->
                <div id="ut-command-fields" class="field-with-border">
                    <div class="row-fluid">
                        <label class="span2" for="code-path">代码位置</label><input class="focus span10" placeholder="输入SVN路径地址或本地代码绝对路径" type="text" value="" name="code-path" id="code-path" />                    </div>
                    <hr/>
                    <label for="ut-command">单元测试命令</label>                    <div class="row-fluid">
                        <textarea class="focus span12" rows="6" placeholder="输入单元测试编译及运行命令，多个命令以分号分割" name="ut-command" id="ut-command"></textarea>                    </div>
                    <hr/>
                    <div class="row-fluid">
                        <label class="span2" for="make-tool">构建方式</label><select class="span2" name="make-tool" id="make-tool">
<option value="" selected="selected">C/C++</option>
<option value="-M">Java</option>
<option value="--python">Python</option>
<option value="--php">PHP</option>
<option value="--perl">Perl</option>
<option value="--shell">Shell</option>
</select><div class="span8"><input value="-y" style="margin: 6px 0px 0px 10px; float: left;" type="checkbox" name="code-coverage" id="code-coverage" /><label style="float: left" for="code-coverage">代码覆盖率</label><input value="-w" style="margin: 6px 0px 0px 10px; float: left;" type="checkbox" name="keep-workspace" id="keep-workspace" /><label style="float: left" for="keep-workspace">保留现场</label><input value="-d" style="margin: 6px 0px 0px 10px; float: left;" type="checkbox" name="debug" id="debug" /><label style="float: left" for="debug">调试信息</label></div>                    </div>
                    <hr/>
                    <div class="row-fluid" style="margin-bottom: 0">
                        <label class="span2" for="other-opts">其他选项</label><input class="focus span10" placeholder="输入其他选项（可选）" type="text" value="" name="other-opts" id="other-opts" />                    </div>
                </div>
                <!-- ut command fields end -->
                <!-- ci command fields start -->
                <div id="ci-command-fields" class="field-with-border">
                    <div class="row-fluid">
                        <label class="span2" for="ci-config">配置文件</label><a class="span2 btn ci-config-new" href="javascript:void(0);">新建</a><a class="span2 btn ci-config" href="javascript:void(0);"><span>上传</span><input type="file" value="" name="ci-config-input" id="ci-config-input" /></a><input type="hidden" value="" name="ci-config-newname" id="ci-config-newname" /><span id="ci-config-filename" class="span4 ci-config-filename" style="line-height: 25px;"></span><a class="span2 btn ci-config-edit" style="display:none" href="javascript:void(0);">编辑</a>                    </div>
                    <div class="row-fluid">
                        <div class="span12"><label class="span2" for="ci-stage">运行阶段</label><input value="u" ext="CI-Stage" style="margin: 6px 2px 0px 10px; float: left;" type="checkbox" name="ci-stage-unittest" id="ci-stage-unittest" /><label style="float: left" for="ci-stage-unittest">单元测试</label><input value="b" ext="CI-Stage" style="margin: 6px 2px 0px 10px; float: left;" type="checkbox" name="ci-stage-build" id="ci-stage-build" /><label style="float: left" for="ci-stage-build">构建</label><input value="d" ext="CI-Stage" style="margin: 6px 2px 0px 10px; float: left;" type="checkbox" name="ci-stage-deploy" id="ci-stage-deploy" /><label style="float: left" for="ci-stage-deploy">部署</label><input value="f" ext="CI-Stage" style="margin: 6px 2px 0px 10px; float: left;" type="checkbox" name="ci-stage-functest" id="ci-stage-functest" /><label style="float: left" for="ci-stage-functest">功能测试</label></div>                    </div>
                    <div class="row-fluid" style="margin-bottom: 0">
                        <label class="span2" for="ci-other-opts">其他选项</label><input class="focus span10" placeholder="输入其他选项（可选）" type="text" value="" name="ci-other-opts" id="ci-other-opts" />                    </div>
                    <hr/>
                    <div class="row-fluid" style="margin-bottom: 0">
                        <label class="span2" for="ci-parser">解析方式</label><select multiple="multiple" placeholder="不解析" class="span10" id="ci-parser" name="ci-parser">
<option value="1">GTest-txt</option>
<option value="2">GTest-xml</option>
<option value="3">Perl</option>
<option value="4">PHPUnit-xml</option>
<option value="5">CPPUnit</option>
<option value="6">JUnit-ant</option>
<option value="7">JUnit-orig</option>
<option value="8">JUnit-mvn</option>
<option value="9">Mocha</option>
<option value="10">Grails</option>
<option value="11">PyUnit</option>
<option value="12">Perl Test::Class</option>
<option value="13">NUnit</option>
<option value="14">ApsaraUnit</option>
<option value="15">ShellUnit</option>
<option value="16">LightFace</option>
<option value="17">Toast</option>
<option value="18">NoseTests</option>
<option value="19">Lua</option>
</select>                    </div>
                </div>
                <!-- ci command fields end -->
            </div>
        </div>
    </div>
    <!-- command fields end -->
    <!-- case fields start -->
    <div id="test-case-fields">
        <div class="row-fluid">
            <label class="span2" for="query-case">查询用例</label><input class="qb-search span10" placeholder="查找" autocomplete="off" type="text" name="search" id="search" /><div class="qb-search-btn" title="显示高级搜索"></div><div class="qb-search-panel"><div class="qb-search-panel-x"></div><div class="item table-list"><span class="table-label">搜索</span><select name="table" id="table">
</select></div><div class="item action"><a class="search-btn" href="javascript:;"><i class="search"></i> 查找</a><a class="reset-query" href="javascript:;">重置搜索</a><a class="save-query" href="javascript:;">将此搜索保存</a></div><div class="query-list"></div></div><div class="save-query-dialog"><div class="dialog-error"></div><input placeholder="搜索名称" class="query-title" type="text" value="" name="Query[title]" id="Query_title" /><div class="save-query-dialog-action"><input class="save" name="yt1" type="button" value="保存" /><input class="cancel" name="yt2" type="button" value="取消" /></div></div>        </div>
        <div class="row-fluid">
            <label class="span2" for="query-result">查询结果</label><select multiple="multiple" class="span10 focus" style="height: 100px;" name="query-result" id="query-result">
</select>        </div>
        <div class="row-fluid">
            <div class="span7 offset5">
                <button class="btn select-case">&darr; 选择</button>
                <button class="btn cancel-case">&uarr; 取消</button>
            </div>
        </div>
        <div class="row-fluid" style="margin-bottom: 0">
            <label class="span2" for="selected-case">已选用例</label><select multiple="multiple" class="span9 focus" style="height: 200px;" id="selected-case" name="testcases[]">
</select>            <div class="span1" style="padding-top: 60px">
                <button class="btn move-up">&uarr;</button><br/><br/>
                <button class="btn move-down">&darr;</button>
            </div>
        </div>        
    </div>
    <!-- case fields end -->
</div>

<div id="env-fields">
    <div class="row-fluid">
        <label class="span2" for="Job_machine_id">运行环境</label><div class="span10" id="machine-selector"><select name="Job[machine_id]" id="Job_machine_id">
<option value="" selected="selected"></option>
<optgroup label="Linux">
</optgroup>
<optgroup label="Windows">
</optgroup>
</select><input class="focus span12" style="margin-left: 0" placeholder="选择测试机" id="Job_machine_id_input" type="text" /></div>    </div>
    <div class="row-fluid">
        <label class="span2" for="Job_sudoer">运行帐号</label><input class="focus span4" name="Job[sudoer]" id="Job_sudoer" type="text" value="root" /><label class="span2" for="Job_timeout">超时时间</label><input class="focus span3" name="Job[timeout]" id="Job_timeout" type="text" value="1440" /><label class="span1">分钟</label>    </div>
    <div class="row-fluid">
        <label class="span2" for="Job_crucial">运行失败时</label><div class="span4" id="curical-opts"><input id="ytJob_crucial" type="hidden" value="" name="Job[crucial]" /><span id="Job_crucial"><input id="Job_crucial_0" value="0" type="radio" name="Job[crucial]" /> <label for="Job_crucial_0">继续执行</label>&nbsp;&nbsp;<input id="Job_crucial_1" value="1" checked="checked" type="radio" name="Job[crucial]" /> <label for="Job_crucial_1">终止任务</label></span></div><label class="span2" for="Job_failed_repeat">重试次数</label><input value="0" type="number" max="99" min="0" maxlength="2" class="focus span1" style="text-align: center" placeholder="0" name="Job[failed_repeat]" id="Job_failed_repeat" />    </div>
</div>
</form></div><div style="display:none" id="dlg-find-project">
<div id="find-project"></div></div><style type="text/css">
    div.stage {margin-bottom: 0px}
</style>

<script type="text/javascript">
$(document).ready(function(){
    var goodexit = false;
    window.onbeforeunload = function () {
        if(!goodexit) {
            return lang.sureToLeave;
        }
    }
    
    $(".btn.return").click(function(){
        var href = getRootPath() + '/task'
                 location.href = href
    })
    $(".btn[name='saverun']").add($(".btn[name='save']")).click(function(){
        if(0 == $(".job").length) {
            alert(lang.needOneJob)
            return false
        }
        goodexit = true;
    })
    $("#Task_project_id-input").add($("#Task_cron_time")).on("keydown", function(event) {
        if(event.keyCode !== 9)
        {
            $(this).trigger("click");
            event.stopPropagation();
            event.preventDefault();
        }
    })
});
</script><script type="text/javascript">
    $(document).ready(function(){
        $("#Task_type").change(function(){
            if(1 == $(this).val()) {
                $("#timer_txt_field").val("0 1 * * *")
            }
        });
    })
</script>        </div>

<script type="text/javascript">
/*<![CDATA[*/
jQuery(function($) {
jQuery('#Task_type').select2({'formatNoMatches':function(){return "未找到匹配项";},'formatInputTooShort':function(input,min){return "请输入 "+(min-input.length)+" 个以上字符";},'formatSelectionTooBig':function(limit){return "最多只能选择 "+limit+" 项";},'formatLoadMore':function(pageNumber){return "正在加载更多结果...";},'formatSearching':function(){return "搜索中...";},'minimumResultsForSearch':10,'placeholder':'选择任务类型'});
jQuery('#Task_responsible').select2({'formatNoMatches':function(){return "未找到匹配项";},'formatInputTooShort':function(input,min){return "请输入 "+(min-input.length)+" 个以上字符";},'formatSelectionTooBig':function(limit){return "最多只能选择 "+limit+" 项";},'formatLoadMore':function(pageNumber){return "正在加载更多结果...";},'formatSearching':function(){return "搜索中...";},'minimumInputLength':2,'ajax':{'url':'/user/lookup2','dataType':'json','data':function (term, page) {
                                return {
                                    term: term,
                                    limit: 10,
                                    page: page
                                }
                            },'results':function (data, page) {
                                var more = (page * 10) < data.total;
                                return {
                                    results: data.users,
                                    more: more
                                };
                            }},'formatResult':function(data){
                            return data.label
                        },'formatSelection':function(data){
                            return (data.realname || data.username);
                        },'initSelection':function (element, callback) {
                            var id = $("#Task_responsible").val();
                            var name = $("#Task_responsible_realname").val();
                            callback({id: id, label: name, realname: name, username: name});
                        }});
$("#Task_project_id-input").MassPicker({'click':function(){
                            data = {productid: $("#product-id").val()};
                            $.get(toast.getProjectTree, data, function(html){
                                $("#dlg-find-project").html(html);
                                $("#dlg-find-project").treeview({
                                    persist: "cookie",
                                    collapsed: true
                                });
                                $("#dlg-find-project a").click(function(){
                                    var projectId = $(this).attr("data-project-id");
                                    var projectPath = $(this).attr("data-project-path");
                                    $("#Task_project_id").val(projectId);
                                    $("#Task_project_id-input").val(projectPath);
                                    $("#dlg-find-project").dialog("close");
                                })
                            })
                            $("#dlg-find-project").dialog("open");
                        }});
$("#Task_cron_time").initial("dlg_Task_cron_time");
jQuery('#dlg_Task_cron_time').dialog({'title':'定时运行','resizable':false,'autoOpen':false,'modal':true,'width':500,'buttons':{'不设定时':function(){$("#Task_cron_time").val(""); $(this).dialog("close");},'保存':function(){if($("#Task_cron_time").setval()) $(this).dialog("close");},'取消':function(){$(this).dialog("close")}},'close':function(event, ui) {
            $("#Task_cron_time").focus();
        }});
jQuery('#Task_report_filter').select2({'formatNoMatches':function(){return "未找到匹配项";},'formatInputTooShort':function(input,min){return "请输入 "+(min-input.length)+" 个以上字符";},'formatSelectionTooBig':function(limit){return "最多只能选择 "+limit+" 项";},'formatLoadMore':function(pageNumber){return "正在加载更多结果...";},'formatSearching':function(){return "搜索中...";},'minimumResultsForSearch':10,'placeholder':'选择任务类型'});
jQuery('#Task_report_to').select2({'formatNoMatches':function(){return "未找到匹配项";},'formatInputTooShort':function(input,min){return "请输入 "+(min-input.length)+" 个以上字符";},'formatSelectionTooBig':function(limit){return "最多只能选择 "+limit+" 项";},'formatLoadMore':function(pageNumber){return "正在加载更多结果...";},'formatSearching':function(){return "搜索中...";},'minimumInputLength':2,'multiple':true,'tokenSeparators':[',',';',' '],'ajax':{'url':'/user/lookup2','dataType':'json','data':function (term, page) {
                                return {
                                    term: term,
                                    limit: 10,
                                    page: page
                                }
                            },'results':function (data, page){
                                var more = (page * 10) < data.total;
                                return {
                                    results: data.users, 
                                    more: more
                                };
                            }},'createSearchChoice':function(term, data) {
                            return {id: term, label: term, realname: term};
                        },'formatResult':function(data){
                            data.id = (data.realname || data.email || data.label);
                            return data.label;
                        },'formatSelection':function(data){
                            return (data.realname || data.email || data.label);
                        },'initSelection':function (element, callback) {
                            var data = []
                            var report_to = $(element).val();
                            var names = report_to.split(",");
                            for(var i = 0; i < names.length; i++)
                            {
                                data.push({id: names[i], label: names[i], realname: names[i], username: names[i]});
                            }
                            callback(data);
                        }});
jQuery('#dlg-add-job').dialog({'autoOpen':false,'resizable':false,'modal':true,'width':700,'close':function(){
            jobForm.clear()
        }});
jQuery('#Job_command_id').combobox({'allowText':true,'showStyle':false,'disableAutocomplete':true,'onSelect':'\n                        if(-1 == $(\"#Job_command_id\").val()) {\n                            item.value = \"\"\n                        }\n                        jobForm.setCommand(item.value, $(\"#Job_command_id\").val())\n                    '});
jQuery('#Command_parser_id').select2({'formatNoMatches':function(){return "未找到匹配项";},'formatInputTooShort':function(input,min){return "请输入 "+(min-input.length)+" 个以上字符";},'formatSelectionTooBig':function(limit){return "最多只能选择 "+limit+" 项";},'formatLoadMore':function(pageNumber){return "正在加载更多结果...";},'formatSearching':function(){return "搜索中...";},'placeholder':'不解析'});
jQuery('#ci-parser').select2({'formatNoMatches':function(){return "未找到匹配项";},'formatInputTooShort':function(input,min){return "请输入 "+(min-input.length)+" 个以上字符";},'formatSelectionTooBig':function(limit){return "最多只能选择 "+limit+" 项";},'formatLoadMore':function(pageNumber){return "正在加载更多结果...";},'formatSearching':function(){return "搜索中...";},'placeholder':'不解析'});
new QueryBuilder("search",{'action':'http://172.16.14.189/#table#/index','queryListUrl':'http://172.16.14.189/query/getlist','createQueryUrl':'http://172.16.14.189/query/create','updateQueryUrl':'http://172.16.14.189/query/update','deleteQueryUrl':'http://172.16.14.189/query/delete','cTable':'case','tables':{'case':{'label':'用例','items':{'id':{'label':'ID','type':'text','operators':{'==':'等于','-=':'不等于','>=':'大于等于','>':'大于','<':'小于','<=':'小于等于','=':'包含','!=':'不包含'}},'name':{'label':'用例名称','type':'text','operators':{'':'含有','-':'不含有'}},'created_by_username':{'label':'创建者','type':'select','operators':{'==':'等于','-=':'不等于'},'data':{'':''}},'updated_by_username':{'label':'修改者','type':'select','operators':{'==':'等于','-=':'不等于'},'data':{'':''}},'create_time':{'label':'创建日期','type':'text','operators':{'':'等于','-':'不等于','>=':'大于等于','>':'大于','<':'小于','<=':'小于等于'}},'update_time':{'label':'修改日期','type':'text','operators':{'':'等于','-':'不等于','>=':'大于等于','>':'大于','<':'小于','<=':'小于等于'}}}}},'keyClick':function(queryStr){
                        $.getJSON(queryStr, {}, function(json){
                            if("success" == json.status){
                                $("#query-result").text("")
                                $.each(json.testcases, function(k, v){
                                    $("#query-result").append("<option value=\"" + k + "\" title=\"" + v.url  + "\">" + v.name + "</option>")
                                })
                            }
                        })
                    },'btnClick':function(queryStr){
                        $.getJSON(queryStr, {}, function(json){
                            if("success" == json.status){
                                $("#query-result").text("")
                                $.each(json.testcases, function(k, v){
                                    $("#query-result").append("<option value=\"" + k + "\" title=\"" + v.url  + "\">" + v.name + "</option>")
                                })
                            }
                        })
                    },'queryClick':function(queryStr){
                        $.getJSON(queryStr, {}, function(json){
                            if("success" == json.status){
                                $("#query-result").text("")
                                $.each(json.testcases, function(k, v){
                                    $("#query-result").append("<option value=\"" + k + "\" title=\"" + v.url  + "\">" + v.name + "</option>")
                                })
                            }
                        })
                    },'reset':function(){
                        $("#query-result").text("")
                    }})
jQuery('#Job_machine_id').combobox({'allowText':false,'showStyle':true,'disableAutocomplete':false,'onSelect':'','onChange':''});
jQuery('#dlg-find-project').dialog({'title':'Sample','autoOpen':false,'resizable':false,'modal':true,'close':function(event, ui) {
            $("#Task_project_id-input").focus();
        }});
});
/*]]>*/
</script>
</body>
</html>